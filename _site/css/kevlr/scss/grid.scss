// ===============================================================
// ========================= class names =========================
// ===============================================================

// only one value
$width: '.width';
$offset: '.offset';
$order: '.order';
$baseline-align: '.baseline-align';
$bottom-align: '.bottom-align';
$vertical-center-align: '.vertical-center-align';
$equal-height: '.equal-height';
$hidden: '.hidden';
$visible: '.visible';
$text-left: '.text-left';
$text-right: '.text-right';
$text-center: '.text-center';
$text-justify: '.text-justify';

// can put several values
$container: '.container';
$row: '.row';
$external-gutter: '.external-gutter';
$column: '.column';
$clearfix: '.clearfix';
$inline: '.inline';
$inline-block: '.inline-block';
$flex: '.flex';

// ===============================================================
// =========================== options ===========================
// ===============================================================

// support
$ie8-9-support: true;
$moz22-27-support: true;

// css options
$box-sizing-border-box-on-every-element: true;

// ===============================================================
// ========================== variables ==========================
// ===============================================================


// main layout
$columns-number: 12;
$column-gutter: 10px;
$container-max-width: none; //none if fluid
$container-min-width: 320px;
$container-align: center; // center, left or right

// larger layout
$larger-layouts-name:					's',				'm',				'l'; // ascending order
$larger-layouts-media-queries:			500px,				800px,				1024px;
$larger-layouts-columns-number:			12,					12,					12;
$larger-layouts-column-gutter:			20px,				20px,				40px;
$larger-layouts-container-max-width:	480px,				768px,				960px; //none if fluid

// General
$media-queries-rules: 'only screen';
$elements-to-order: -3, 3; // order propriety for flex display

// ===============================================================
// ========================= grid system =========================
// ===============================================================

// ===================================
// ============= mixins ==============
// ===================================

@mixin media($layout-name) {
	@each $layout in $all-layouts {
		@if (nth($layout, 1) == $layout-name) {
			@media #{$media-queries-rules} and (min-width: nth($layout, 2)) {
				@content;
			}
		}
	}
}

@mixin gutter($type, $directions, $ratio: 1) {
	@each $direction in $directions {
		#{$type}-#{$direction}: $column-gutter * $ratio;
	}
	@each $layout in $all-layouts {
		@media #{$media-queries-rules} and (min-width: nth($layout, 2)) {
			@each $direction in $directions {
				#{$type}-#{$direction}: nth($layout, 4) * $ratio;
			}
		}
	}
}

// ===================================
// ========== general style ==========
// ===================================

$all-layouts: zip($larger-layouts-name, $larger-layouts-media-queries, $larger-layouts-columns-number, $larger-layouts-column-gutter, $larger-layouts-container-max-width);


@if $box-sizing-border-box-on-every-element == true {
	* {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		box-sizing: border-box;
	}
	*:before, *:after {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		box-sizing: border-box;
	}
}

// ========== clearfix ==========

%clearfix {
	&:before,
	&:after {
			content: " ";
			display: table;
			display: -webkit-flex;
			display: -ms-flexbox;
			display: flex;
	}

	&:after {
			clear: both;
	}
}

#{$clearfix} {
	width: 100%;
	@extend %clearfix;
}

// ===================================
// =========== main layout ===========
// ===================================

// ========== main layout container ==========

#{$container} {
	@if $container-max-width != none {
	max-width: $container-max-width;
	}
	min-width: $container-min-width;
	@if $container-align == center {
	margin: 0 auto;
	} @else if $container-align == right {
	margin: 0 0 0 auto;
	}
}

// ========== main layout row ==========

#{$row} {
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
	
	@if $moz22-27-support {
		@supports not (flex-wrap: wrap) {
			display: block;
		}
	}
	
	-webkit-flex-wrap: wrap;
	-ms-flex-wrap: wrap;
	flex-wrap: wrap;
	
	-webkit-align-items: flex-start;
	-ms-flex-align: start;
	align-items: flex-start;
	
	@if $ie8-9-support or $moz22-27-support {
		@extend %clearfix;
	}
}

#{$external-gutter} {
	margin-left: $column-gutter / 2;
	margin-right: $column-gutter / 2;
}

// ========== main layout columns ==========

#{$column} {
	padding-left: $column-gutter / 2;
	padding-right: $column-gutter / 2;
	width: 100%;
	@if $ie8-9-support or $moz22-27-support {
	min-height: 1px;
	float: left;
	}
	@if $box-sizing-border-box-on-every-element == false {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		box-sizing: border-box;
	}
}

// columns width

@for $i from 1 through $columns-number {
	#{$width}#{$i} {
		width: 100% / $columns-number * $i;
	}
}

// columns offset

@for $i from 1 through $columns-number {
	#{$offset}#{$i} {
		margin-left: 100% / $columns-number * $i;
	}
}

// ========== flex options ==========

// order

@for $i from nth($elements-to-order, 1) through nth($elements-to-order, 2) {
	#{$order}#{$i} {
		-webkit-order: #{$i};
		-ms-flex-order: #{$i};
		order: #{$i};
	}
}

// baseline align

#{$baseline-align} {
	-webkit-align-items: baseline;
	-ms-flex-align: baseline;
	align-items: baseline;
}

// bottom align

#{$bottom-align} {
	-webkit-align-items: flex-end;
	-ms-flex-align: end;
	align-items: flex-end;
}

// center align

#{$vertical-center-align} {
	-webkit-align-items: center;
	-ms-flex-align: center;
	align-items: center;
}

// equal height

#{$equal-height} {
	-webkit-align-items: stretch;
	-ms-flex-align: stretch;
	align-items: stretch;
}

// ========== display ==========

#{$inline} {
	display: inline;
}

#{$inline-block} {
	display: inline-block;
}

#{$flex} {
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

// ========== text alignment ==========

#{$text-left} {
	text-align: left;
}

#{$text-right} {
	text-align: right;
}

#{$text-center} {
	text-align: center;
}

#{$text-justify} {
	text-align: justify;
}

// ========== visibility ==========

#{$hidden} {
	display: none;
}

// ===================================
// ========== media queries ==========
// ===================================

@each $layout in $all-layouts {
	
	@if (nth($layout, 1)) {
	
		@include media(nth($layout, 1)) {
			
			// ========== responsive container ==========
			
			#{$container} {
				max-width: nth($layout, 5);
			}
			
			// ========== responsive row ==========
			
			#{$external-gutter} {
				margin-left: - (nth($layout, 4) / -2);
				margin-right: - (nth($layout, 4) / -2);
			}
			
			// ========== responsive columns ==========
			
			#{$column} {
				padding-left: - (nth($layout, 4) / -2);
				padding-right: - (nth($layout, 4) / -2);
			}
			
			// columns width

			@for $i from 1 through nth($layout, 3) {
				#{$width}#{$i}--#{nth($layout, 1)} {
					width: 100% / nth($layout, 3) * $i;
				}
			}

			// columns offset

			@for $i from 1 through nth($layout, 3) {
				#{$offset}#{$i}--#{nth($layout, 1)} {
					margin-left: 100% / nth($layout, 3) * $i;
				}
			}

			// ========== responsive flex options ==========

			// responsive order

			@for $i from nth($elements-to-order, 1) through nth($elements-to-order, 2) {
				.order#{$i}--#{nth($layout, 1)} {
					-webkit-order: #{$i};
					-ms-flex-order: #{$i};
					order: #{$i};
				}
			}

			// responsive baseline align

			#{$baseline-align}--#{nth($layout, 1)} {
				-webkit-align-items: baseline;
				-ms-flex-align: baseline;
				align-items: baseline;
			}

			// responsive bottom align

			#{$bottom-align}--#{nth($layout, 1)} {
				-webkit-align-items: flex-end;
				-ms-flex-align: end;
				align-items: flex-end;
			}

			// responsive center align

			#{$vertical-center-align}--#{nth($layout, 1)} {
				-webkit-align-items: center;
				-ms-flex-align: center;
				align-items: center;
			}

			// responsive equal height

			#{$equal-height}--#{nth($layout, 1)} {
				-webkit-align-items: stretch;
				-ms-flex-align: stretch;
				align-items: stretch;
			}

			// responsive text alignment

			#{$text-left}--#{nth($layout, 1)} {
				text-align: left;
			}

			#{$text-right}--#{nth($layout, 1)} {
				text-align: right;
			}

			#{$text-center}--#{nth($layout, 1)} {
				text-align: center;
			}

			#{$text-justify}--#{nth($layout, 1)} {
				text-align: justify;
			}

			// ========== responsive visibility ==========

			#{$hidden}--#{nth($layout, 1)} {
				display: none;
			}

			#{$visible}--#{nth($layout, 1)} {
				display: block;
				
				&#{$inline} {
					display: inline;
				}

				&#{$inline-block} {
					display: inline-block;
				}

				&#{$flex},
				&#{$row} {
					display: -webkit-flex;
					display: -ms-flexbox;
					display: flex;
				}
			}
		}

	}

}
